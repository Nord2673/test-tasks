<html>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <head>
        <title>Cube</title>
        <style>
            :root{
                --layer-1-color: purple;
                --layer-2-color: blue;
                --layer-3-color: green;
                --layer-4-color: yellow;
                --layer-5-color: orange;
                --layer-6-color: red;
            }
                        
            * {
                box-sizing: border-box;
            }
            body {
                margin: 0;
                font-size: 24px;
                font-weight: 400;
                line-height: 1.5;
            }

            .main-container {
                width: 80%;
                margin: auto;
            }
            .main-wrapper {
                box-shadow: 0px 5px 10px 2px #223c5033;
            }

            /* #region input  */
            .layers-amount-label {
                display: inline-block;
                text-align: right;
            }
            .layers-amount-input {
                padding: 5px 5px;
                max-width: 30px;
                font-size: 20px;
            }
            .layers-amount-input:invalid + .validity::after {
                position: absolute;
                content: "✖";
                padding-left: 5px;
            }
            .layers-amount-input:valid + .validity::after {
                position: absolute;
                content: "✓";
                padding-left: 5px;
            }
            .button-container {
                position: relative;
                width: fit-content;
                padding: 0px 10px;
                border-radius: 5px;
                cursor: pointer;
                color: #fff;
                background-color: #67bcb8;
            }
            /* #endregion input  */
                        
            .layer-6{
                --layer-color: red;
                position: absolute;
                z-index: 6;
                transform: translateZ(500px);
                background-color: var(--layer-6-color);
                width: 100%;
                height: 100%;
            }
            .layer-5{
                --layer-color: orange;
                position: absolute;
                z-index: 5;
                transform: translateZ(400px);
                background-color: var(--layer-5-color);
                width: 100%;
                height: 100%;
            }
            .layer-4{
                --layer-color: yellow;
                position: absolute;
                z-index: 4;
                transform: translateZ(300px);
                background-color: var(--layer-4-color);
                width: 100%;
                height: 100%;
            }
            .layer-3{
                --layer-color: green;
                position: absolute;
                z-index: 3;
                transform: translateZ(200px);
                background-color: var(--layer-3-color);
                width: 100%;
                height: 100%;
            }
            .layer-2{
                --layer-color: blue;
                position: absolute;
                z-index: 2;
                transform: translateZ(100px);
                background-color: var(--layer-2-color);
                width: 100%;
                height: 100%;
            }
            .layer-1{
                --layer-color: purple;
                position: absolute;
                z-index: 1;
                background-color: var(--layer-1-color);
                width: 100%;
                height: 100%;
            }

            .parent-cube-content {
                position: relative;
                width: 500px;
                height: 500px;
                perspective: 800px;
                perspective-origin: 50% -20%;
                transform-style: preserve-3d;
            }
            .cube-side {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 100px;
                height: 100px;
                position: absolute;
                backface-visibility: inherit;
                font-size: 60px;
                color: #fff;
                border: 1px solid black;
            }

            .front {
                background: var(--layer-color);
                transform: translateZ(50px);
            }
            .back {
                background: var(--layer-color);
                transform: rotateY(180deg) translateZ(50px);
            }
            .right {
                background: var(--layer-color);
                filter: brightness(80%);
                transform: rotateY(90deg) translateZ(50px);
            }
            .left {
                background: var(--layer-color);
                filter: brightness(80%);
                transform: rotateY(-90deg) translateZ(50px);
            }
            .top {
                background: var(--layer-color);
                filter: brightness(120%);
                transform: rotateX(90deg) translateZ(50px);
            }
            .bottom {
                background: var(--layer-color);
                filter: brightness(50%);
                transform: rotateX(-90deg) translateZ(50px);
            }
        </style>
    </head>
    <body>
        <div class="main-container">
            <div class="main-wrapper">
                <div class="input-container">
                    <div>
                        <span class="layers-amount-label">Введите кол-во слоев (1-6):</span>
                        <input type="text" class="layers-amount-input" name="layers-amount" required maxlength="1" />
                        <span class="validity"></span>
                    </div>
                    <div class="button-container">
                        <div class="button-wrapper">
                            <div class="button-text" onclick="drawCube()">Подтвердить</div>
                        </div>
                    </div>
                </div>
                <div class="parent-cube-container">
                    <div class="parent-cube-content">
                        
                    </div>
                </div>
            </div>
        </div>
        <script>
            const test = [];
            var testt = test.length;
            class Cube {
                width = "100px";
                height = "100px";
                posX;
                posY;
                layer;
                constructor(posX, posY, layer) {
                    this.posX = posX;
                    this.posY = posY;
                    this.layer = layer + 1;
                }
                draw() {
                    const layerElement = document.querySelector(`.layer-${this.layer}`);
                    const container = document.createElement("div");
                    const front = document.createElement("div");
                    const back = document.createElement("div");
                    const right = document.createElement("div");
                    const left = document.createElement("div");
                    const top = document.createElement("div");
                    const bottom = document.createElement("div");

                    layerElement.appendChild(container);
                    container.classList.add("small-cube-wrapper");
                    //дописать сдвиг
                    container.appendChild(front);
                    front.classList.add("cube-side", "front");
                    container.appendChild(back);
                    back.classList.add("cube-side", "back");
                    container.appendChild(right);
                    right.classList.add("cube-side", "right");
                    container.appendChild(left);
                    left.classList.add("cube-side", "left");
                    container.appendChild(top);
                    top.classList.add("cube-side", "top");
                    container.appendChild(bottom);
                    bottom.classList.add("cube-side", "bottom");
                }
            }

            function drawCube() {
                let layersAmount = document.querySelector(".layers-amount-input").value;
                if (layersAmount < 7 && layersAmount > 0) {
                    createLayers(layersAmount);
                    createCubes(layersAmount);
                }
            }

            function createLayers(layersAmount){
                let bigCube = document.querySelector(".parent-cube-content");
                for (let i = layersAmount; i > 0; i--) {
                    bigCube.appendChild(document.createElement("div")).classList.add(`layer-${i}`);
                }
            }

            function createCubes(layersAmount){
                let amountOfCubes = Math.pow(layersAmount, 3);
                let amountOfCubesInLayer = layersAmount * layersAmount;
                let counter = 0;
                const cubesInLayers = new Array(layersAmount);
                for (let i = 0; i < layersAmount; i++) {
                    cubesInLayers[i] = [];
                }

                while(counter < amountOfCubes) {
                    let selectedLayer = Math.floor(Math.random() * layersAmount);
                    let curLength = cubesInLayers[selectedLayer].length;
                    if(curLength < amountOfCubesInLayer) {
                        cubesInLayers[selectedLayer][curLength] = new Cube(curLength % layersAmount, Math.floor(curLength / layersAmount), selectedLayer);
                        cubesInLayers[selectedLayer][curLength].draw();
                        counter++;
                    }
                }
            }
        </script>
    </body>
</html>
